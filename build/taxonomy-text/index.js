(()=>{"use strict";const e=window.wp.blocks,t=JSON.parse('{"UU":"query-filter/taxonomy-text"}'),l=window.wp.i18n,r=window.wp.blockEditor,a=window.wp.components,i=window.ReactJSXRuntime,o=[{label:(0,l.__)("Tag","query-filter"),value:"tag"},{label:(0,l.__)("Category","query-filter"),value:"category"},{label:(0,l.__)("Sort","query-filter"),value:"sort"},{label:(0,l.__)("Page Number","query-filter"),value:"page"},{label:(0,l.__)("Yoast Primary Category","query-filter"),value:"yoast_primary_category"}],n=[{label:(0,l.__)("Title","query-filter"),value:"title"},{label:(0,l.__)("Description","query-filter"),value:"description"},{label:(0,l.__)("Page Number","query-filter"),value:"page"}],s=window.wp.richText,u=window.wp.primitives;var y=(0,i.jsx)(u.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,i.jsx)(u.Path,{d:"M17.5 4v5a2 2 0 0 1-2 2h-7a2 2 0 0 1-2-2V4H8v5a.5.5 0 0 0 .5.5h7A.5.5 0 0 0 16 9V4h1.5Zm0 16v-5a2 2 0 0 0-2-2h-7a2 2 0 0 0-2 2v5H8v-5a.5.5 0 0 1 .5-.5h7a.5.5 0 0 1 .5.5v5h1.5Z"})});const p=window.wp.element,f="query-filter/taxonomy-inline-text",c="data-query-filter-text",g={filterType:"tag",valueType:"title",prefix:"",suffix:"",link:!1,showAfterFirstPage:!0},_=[{label:(0,l.__)("Tag","query-filter"),value:"tag"},{label:(0,l.__)("Category","query-filter"),value:"category"},{label:(0,l.__)("Sort","query-filter"),value:"sort"},{label:(0,l.__)("Page Number","query-filter"),value:"page"},{label:(0,l.__)("Yoast Primary Category","query-filter"),value:"yoast_primary_category"}],x=[{label:(0,l.__)("Title","query-filter"),value:"title"},{label:(0,l.__)("Description","query-filter"),value:"description"},{label:(0,l.__)("Page Number","query-filter"),value:"page"}],v=(e,t)=>e.find((e=>e.value===t))?.label||t;(0,s.registerFormatType)(f,{title:(0,l.__)("Taxonomy Text","query-filter"),tagName:"span",className:"taxonomy-text-inline",attributes:{[c]:c},edit:({value:e,onChange:t,isActive:o,activeAttributes:n})=>{const u=(0,p.useMemo)((()=>(e=>{if(!e)return g;try{var t,l;const r=JSON.parse(e);return{filterType:r.filterType||g.filterType,valueType:r.valueType||g.valueType,prefix:r.prefix||"",suffix:r.suffix||"",link:null!==(t=r.link)&&void 0!==t?t:g.link,showAfterFirstPage:null!==(l=r.showAfterFirstPage)&&void 0!==l?l:g.showAfterFirstPage}}catch(e){return g}})(n?.[c])),[n?.[c]]),[T,h]=(0,p.useState)(!1),[d,b]=(0,p.useState)(u);(0,p.useEffect)((()=>{b(u)}),[u]),(0,p.useEffect)((()=>{"page"===d.filterType&&"page"!==d.valueType?b((e=>({...e,valueType:"page"}))):"sort"===d.filterType&&"description"===d.valueType&&b((e=>({...e,valueType:"title"})))}),[d.filterType,d.valueType]);const q="page"===d.filterType?x.filter((e=>"page"===e.value)):"sort"===d.filterType?x.filter((e=>"title"===e.value)):x;return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(r.RichTextToolbarButton,{icon:y,title:(0,l.__)("Taxonomy Text","query-filter"),onClick:()=>h(!0),isActive:o}),T&&(0,i.jsxs)(a.Modal,{title:(0,l.__)("Dynamic Taxonomy Text","query-filter"),onRequestClose:()=>h(!1),children:[(0,i.jsx)(a.SelectControl,{label:(0,l.__)("Filter Source","query-filter"),value:d.filterType,options:_,onChange:e=>{b((t=>({...t,filterType:e,valueType:"page"===e?"page":"sort"===e&&"description"===t.valueType?"title":t.valueType})))}}),(0,i.jsx)(a.SelectControl,{label:(0,l.__)("Value Type","query-filter"),value:d.valueType,options:q,disabled:"page"===d.filterType,onChange:e=>b((t=>({...t,valueType:e})))}),(0,i.jsx)(a.TextControl,{label:(0,l.__)("Prefix Text","query-filter"),value:d.prefix,onChange:e=>b((t=>({...t,prefix:e})))}),(0,i.jsx)(a.TextControl,{label:(0,l.__)("Suffix Text","query-filter"),value:d.suffix,onChange:e=>b((t=>({...t,suffix:e})))}),["tag","category","yoast_primary_category"].includes(d.filterType)&&(0,i.jsx)(a.ToggleControl,{label:(0,l.__)("Link to term archive","query-filter"),checked:!!d.link,onChange:e=>b((t=>({...t,link:e})))}),"page"===d.filterType&&(0,i.jsx)(a.ToggleControl,{label:(0,l.__)("Only show after page 1","query-filter"),checked:!!d.showAfterFirstPage,onChange:e=>b((t=>({...t,showAfterFirstPage:e})))}),(0,i.jsx)(a.Flex,{justify:"flex-start",children:(0,i.jsx)(a.FlexItem,{children:(0,i.jsx)(a.Button,{variant:"primary",onClick:()=>{const r={[c]:JSON.stringify(d)},a=e.start===e.end;let i=e;if(a&&!o){const e=(e=>{const t=[(0,l.__)("taxonomy","query-filter"),v(_,e.filterType).toLowerCase()],r="sort"===e.filterType&&"page"!==e.valueType?(0,l.__)("title","query-filter"):v(x,e.valueType);return t.push(r.toLowerCase()),t.join(" ")})(d);i=(0,s.insert)(i,e);const t=i.start,r=t-e.length;i={...i,start:r,end:t}}const n=(0,s.applyFormat)(i,{type:f,attributes:r});t(n),h(!1)},children:(0,l.__)("Apply","query-filter")})})})]})]})}}),(0,e.registerBlockType)(t.UU,{edit:function({attributes:e,setAttributes:t}){const{filterType:s="tag",valueType:u="title",prefix:y="",suffix:p="",link:f=!1,showAfterFirstPage:c=!0}=e,g=(0,r.useBlockProps)({className:`taxonomy-text taxonomy-text--${s}`}),_="sort"===s?(0,l.__)("Selected Sort","query-filter"):"description"===u?(0,l.__)("Selected Term Description","query-filter"):(0,l.__)("Selected Term","query-filter"),x="page"===s?n.filter((e=>"page"===e.value)):"sort"===s?n.filter((e=>"title"===e.value)):n;return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(r.InspectorControls,{children:(0,i.jsxs)(a.PanelBody,{title:(0,l.__)("Display Settings","query-filter"),children:[(0,i.jsx)(a.SelectControl,{label:(0,l.__)("Filter Source","query-filter"),value:s,options:o,onChange:e=>{t({filterType:e,valueType:"page"===e?"page":"sort"===e&&"description"===u?"title":u})}}),["tag","category","yoast_primary_category"].includes(s)&&(0,i.jsx)(a.ToggleControl,{label:(0,l.__)("Link to term archive","query-filter"),checked:!!f,onChange:e=>t({link:e})}),(0,i.jsx)(a.SelectControl,{label:(0,l.__)("Value Type","query-filter"),value:u,options:x,disabled:"page"===s,onChange:e=>t({valueType:e})}),"page"===s&&(0,i.jsx)(a.ToggleControl,{label:(0,l.__)("Only show after page 1","query-filter"),checked:!!c,onChange:e=>t({showAfterFirstPage:e})}),(0,i.jsx)(a.TextControl,{label:(0,l.__)("Prefix Text","query-filter"),value:y,onChange:e=>t({prefix:e}),placeholder:""}),(0,i.jsx)(a.TextControl,{label:(0,l.__)("Suffix Text","query-filter"),value:p,onChange:e=>t({suffix:e}),placeholder:""})]})}),(0,i.jsx)("span",{...g,children:`${y||""}${_}${p||""}`})]})}})})();